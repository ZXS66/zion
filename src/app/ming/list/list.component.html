<h2>{{pageTitle}}</h2>

<div class="actions">
	<mat-form-field class="full-width" style="min-width: 16em">
		<mat-label>搜索</mat-label>
		<input matInput [(ngModel)]="searchTerm" name="searchTerm" type="text" placeholder="按姓名搜索，始终显示前10条。"
			(keydown.enter)="doSearch()" />
		@if (searchTerm&&searchTerm.length){
		<button mat-icon-button matSuffix color="primary" aria-label="Search" (click)="doSearch()">
			<mat-icon>search</mat-icon>
		</button>
		}
	</mat-form-field>
</div>

<div class="mat-elevation-z1">
	@if (loadingStatus===1){
	<!-- loading in progress -->
	<mat-spinner [title]="message.LOADING"></mat-spinner>
	}
	@else if(loadingStatus===2) {
	<p class="body-2" *ngIf="!(data&&data.length)">{{message.EMPTY}}</p>
	<div class="table-container" *ngIf="data&&data.length">
		<table mat-table [dataSource]="data">
			<ng-container matColumnDef="人物">
				<th mat-header-cell *matHeaderCellDef>人物</th>
				<td mat-cell *matCellDef="let d">
					<a mat-stroked-button [routerLink]="['/ming/profile', d.id]" queryParamsHandling="merge" title="详情">
						{{d.name}}({{d.pin_yin}})
					</a>
				</td>
			</ng-container>
			<ng-container matColumnDef="生卒">
				<th mat-header-cell *matHeaderCellDef>生卒</th>
				<td mat-cell *matCellDef="let d">{{d.birthday || '?'}}➡️{{d.deathday || '?'}}</td>
			</ng-container>
			<ng-container matColumnDef="年号封号谥号">
				<th mat-header-cell *matHeaderCellDef>年号封号谥号</th>
				<td mat-cell *matCellDef="let d">
					{{d.spread?.['年号']}}
					{{d.spread?.['封号']}}
					{{d.spread?.['谥号']}}
				</td>
			</ng-container>
			<ng-container matColumnDef="简介">
				<th mat-header-cell *matHeaderCellDef>简介</th>
				<td mat-cell *matCellDef="let d">{{d.summary}}</td>
			</ng-container>
			<ng-container matColumnDef="在位时间">
				<th mat-header-cell *matHeaderCellDef>在位时间</th>
				<td mat-cell *matCellDef="let d">{{d.spread?.['在位时间']}}</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr mat-row *matRowDef="let d; columns: displayedColumns;"></tr>
		</table>
	</div>
	<!-- <mat-paginator [length]="resultsLength" [pageSize]="30" aria-label="Select page of GitHub search results"></mat-paginator> -->
	}
	@else if(loadingStatus===3) {
	<p class="body-2">{{message.ERROR}}</p>
	}
</div>
<div class="actions" style="padding: 1em 0;">
	<a mat-stroked-button routerLink="/ming/tree" queryParamsHandling="merge">
		<mat-icon>account_tree</mat-icon>
		成员结构图
	</a>
	@if (manipulationMode){
	<a mat-flat-button color="primary" routerLink="/ming/entry" queryParamsHandling="merge">
		<mat-icon>add</mat-icon>
		添加新成员
	</a>
	}
</div>